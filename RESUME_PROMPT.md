# RESUME_PROMPT.md - 作業再開用プロンプト

> このファイルには、Claude / ChatGPT に投げればプロジェクトを即座に理解して
> 作業再開できる「再開用プロンプト」を記載しています。
>
> **使い方**: 下記のプロンプトをコピーして AI に投げてください。

---

## 重要なルール（AIへの指示）

**作業完了時は必ず以下のファイルを更新すること：**

| ファイル | 更新タイミング |
|----------|----------------|
| `CURRENT_STATUS.md` | 機能追加・バグ修正・設計変更のたびに |
| `PROJECT_CONTEXT.md` | アーキテクチャ変更時のみ |
| `RESUME_PROMPT.md` | プロンプト自体の改善時のみ |

**更新すべき内容：**
- 「直近で完了した作業履歴」に日付と内容を追加
- 「次に着手すべき作業」を最新化
- 課題やTODOの状態（✅完了、未着手など）を更新

---

## 基本再開プロンプト（これをコピー）

```
あなたは、Google Apps Script / Googleスプレッドシート / iPhone Safari 向け
Webアプリ開発のエンジニアとして、以下のプロジェクトを引き継いでください。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【プロジェクト概要】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ 名称: 家族ポータル
■ 目的: 家族2人（夫婦）専用の情報共有PWA
■ 機能:
  - ポータル画面（トップ画像 + ピン留めメモ）
  - 共有メモ（追加/ピン留め/削除）
  - 今年やりたいこと（年別目標管理、ステータス管理）
  - 買い物リスト（チェックで購入済み）
  - 設定（API URL設定）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【技術スタック】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

- フロントエンド: HTML / CSS / Vanilla JS（SPA方式、フレームワークなし）
- ホスティング: GitHub Pages（public repo）
- バックエンド: Google Apps Script（Webアプリとしてデプロイ）
- データベース: Google スプレッドシート（4シート: Memos, Wishes, Shopping, Settings）
- 画像保存: Google Drive（限定公開、GAS経由でBase64取得）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【ファイル構成】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

okazaki_portal/
├── index.html          # メインHTML（全画面をここに含むSPA）
├── manifest.json       # PWAマニフェスト
├── css/styles.css      # 全スタイル
├── js/app.js           # 全JavaScript（v2.1）
├── gas/Code.gs         # GASに貼り付けるコード
├── icons/              # アプリアイコン
├── SETUP.md            # セットアップ手順
├── PROJECT_CONTEXT.md  # プロジェクト全体像
├── CURRENT_STATUS.md   # 現在の状態・課題
└── RESUME_PROMPT.md    # このファイル

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【重要な設計方針】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. GitHub Pages は public だが、データは一切含まない
2. GAS URLを知らなければデータにアクセスできない設計
3. iPhone Safari 最優先（CORS対応、URL長制限対応済み）
4. 家庭用なので過剰設計しない
5. Firebase は将来検討中だが、現時点では GAS + スプレッドシート

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【直近で解決した技術課題】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ 問題: 画像アップロードで Safari の URL 長制限超過
■ 原因: Base64 を GET パラメータに含めていた
■ 解決策:
  - 画像アップロードのみ POST に変更
  - Content-Type: text/plain（CORSプリフライト回避）
  - GAS側で e.postData.contents を JSON.parse
  - フロントで1MB以下に自動圧縮

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【現在の状態】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 全機能実装完了・動作確認済み
✅ 画像アップロード安定動作
⚠️ スプレッドシートのレスポンスが遅め（1-3秒）
⚠️ ローカルキャッシュ未実装

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【今後やりたいこと（優先順）】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. ローカルキャッシュ導入（前回データ即表示→バックグラウンド更新）
2. 楽観的UI更新（操作後すぐにUI反映）
3. 必要に応じて機能追加（メモ編集など）
4. 将来的には Firebase 移行を検討

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

まず、このディレクトリのコードを読み込んで内容を把握してください。
把握できたら、現在の状態と次にやるべきことを簡潔に報告してください。
```

---

## 状況別プロンプト

### A. 特定の機能を追加したい場合

```
上記の基本プロンプト + 以下を追加：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【今回の依頼】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

以下の機能を追加してください：
[ここに追加したい機能を具体的に書く]

【条件】
- GAS + スプレッドシート構成は変更しない
- iPhone Safari で動作確認できる形で
- 既存のコードスタイルに合わせる
```

### B. バグを修正したい場合

```
上記の基本プロンプト + 以下を追加：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【今回の依頼】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

以下のバグを修正してください：

■ 症状:
[何が起きているか]

■ 再現手順:
1. [手順1]
2. [手順2]
3. [手順3]

■ 期待する動作:
[どうなるべきか]

■ 端末/ブラウザ:
[iPhone Safari / PC Chrome など]
```

### C. パフォーマンス改善したい場合

```
上記の基本プロンプト + 以下を追加：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【今回の依頼】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

体感速度を改善したいです。

【現状の問題】
- ポータル画面表示に 1-3 秒かかる
- 毎回 GAS に問い合わせが発生している

【制約】
- Firebase への移行はまだしない
- GAS + スプレッドシート構成のまま改善

【検討している方法】
- ローカルキャッシュ（localStorage）の導入
- 楽観的UI更新
- 他に良い方法があれば提案してください
```

---

## Claude Code 用の簡易プロンプト

Claude Code (CLI) で作業再開する場合は、以下の短縮版も使えます：

```
このディレクトリは「家族ポータル」というPWAプロジェクトです。
GAS + スプレッドシート + GitHub Pages の構成で、
iPhone Safari をメインターゲットにしています。

まず以下のファイルを読んで状況を把握してください：
- PROJECT_CONTEXT.md（全体像）
- CURRENT_STATUS.md（現在の状態）

把握できたら、次に何をすべきか提案してください。
```

---

## 注意事項

1. **API URL や スプレッドシートID は SETUP.md に記載**
   - これらの値はプロンプトに含めない（セキュリティ上）

2. **GAS の変更時はデプロイが必要**
   - 「デプロイを管理」→「新バージョン」で更新
   - 新規デプロイすると URL が変わるので注意

3. **フロントエンドの変更時はバージョン番号を更新**
   - `app.js?v=2.1` → `app.js?v=2.2` のように
   - キャッシュ対策

---

> 最終更新: 2025年2月
> 作業内容に応じて、このプロンプトも更新してください。
